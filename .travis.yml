language: python
python:
  - 2.7
  - 3.2
  - 3.3
  # this should work -- re-enable once travis has 3.4 installed!
  # - 3.4
before_install:
  - sudo apt-get -qq install nginx
  # This has to be done to let it create some files that nginx insists must exist, yet only root can create.
  - sudo /etc/init.d/nginx start
  - pip install coverage nose-cov lxml
  # don't bother compiling Cython itself, we're only going to use it once
  - pip install --install-option="--no-cython-compile" Cython
install:
  - python setup.py sdist
  - mkdir empty
  - cd empty
  - pip install ../dist/*
  - INSTALLDIR=$(python -c "import os; import zss; print(os.path.dirname(zss.__file__))")
script:
  # tell the tests that missing the 'zss' script is a hard-error
  - export ZSS_REQUIRE_SCRIPT_TEST=1
  - nosetests --all-modules --with-cov --cov-conf ./travis-coveragerc --cov-report term-missing --cov ${INSTALLDIR} zss
after_success:
  - pip install coveralls && coveralls
notifications:
  email:
  - njs@pobox.com
